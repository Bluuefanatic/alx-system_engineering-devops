#!/usr/bin/env bash
# Script: user_story.sh
# Description: Display a fictional story based on /etc/passwd file using while loop + IFS.

# File path
passwd_file="/etc/passwd"

# Check if the file exists
if [ -e "$passwd_file" ]; then

    # Use while loop to read each line in the file
    while IFS=: read -r username _ uid gid info home shell; do
        # Extract additional information
        group=$(getent group "$gid" | cut -d: -f1)
        command=$(basename "$shell")
        password=$(getent shadow "$username" | cut -d: -f2)

        # Display the fictional story
        echo "The user $username is part of the $group gang,"
        echo "lives in $home and rides $command."
        echo "USER ID's place is protected by the passcode $password,"
        echo "more info about the user here: $info"
        echo "----------------------"
    done < "$passwd_file"

else
    echo "Error: $passwd_file does not exist."
fi
